appName: "Search Pipeline"
basePackage: "org.pipelineframework.search"
transport: "REST"
steps:
  - name: "Crawl Source"
    service: "org.pipelineframework.search.CrawlSourceService"
    input: "org.pipelineframework.search.domain.CrawlRequest"
    output: "org.pipelineframework.search.domain.RawDocument"
  - name: "Parse Document"
    service: "org.pipelineframework.search.ParseDocumentService"
    input: "org.pipelineframework.search.domain.RawDocument"
    output: "org.pipelineframework.search.domain.ParsedDocument"
  - name: "Tokenize Content"
    service: "org.pipelineframework.search.TokenizeContentService"
    input: "org.pipelineframework.search.domain.ParsedDocument"
    output: "org.pipelineframework.search.domain.TokenBatch"
  - name: "Index Document"
    service: "org.pipelineframework.search.IndexDocumentService"
    input: "org.pipelineframework.search.domain.TokenBatch"
    output: "org.pipelineframework.search.domain.IndexAck"

aspects:
  persistence:
    enabled: true
    scope: "GLOBAL"
    position: "AFTER_STEP"
    order: 0
    config:
      pluginImplementationClass: "org.pipelineframework.plugin.persistence.PersistenceService"
  cache:
    enabled: true
    scope: "GLOBAL"
    position: "AFTER_STEP"
    order: 5
  cache-invalidate:
    enabled: true
    scope: "STEPS"
    position: "BEFORE_STEP"
    order: -4
    config:
      targetSteps:
        - "ProcessTokenizeContentService"
      pluginImplementationClass: "org.pipelineframework.plugin.cache.CacheInvalidationService"
  cache-invalidate-all:
    enabled: true
    scope: "STEPS"
    position: "BEFORE_STEP"
    order: -5
    config:
      targetSteps:
        - "ProcessParseDocumentService"
      pluginImplementationClass: "org.pipelineframework.plugin.cache.CacheInvalidationAllService"
